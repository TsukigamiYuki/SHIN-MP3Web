<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SHIN MP3</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="icon" href="https://styles.redditmedia.com/t5_9fe3c1/styles/communityIcon_ihjz0x1w4iic1.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tangerine:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

  <div class="toggle-button" id="toggleButton">
    <button onclick="toggleSidebar()">☰</button>
  </div>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div id="album-sidebar" class="album-sidebar">
      <button class="close-button" onclick="toggleSidebar()">X</button>
      <h3>Select Album</h3>
      <ul>
        <li class="album-item" id="album1" onclick="selectAlbum(0)">Show By Rock</li>
        <li class="album-item" id="album2" onclick="selectAlbum(1)">Dohna Dohna</li>
        <li class="album-item" id="album3" onclick="selectAlbum(2)">Will Stetson</li>
        <li class="album-item" id="album4" onclick="selectAlbum(3)">GARNiDELiA</li>
      </ul>
    </div>
  </div>

  <div class="Container">
    <h1>Enma-Tei</h1>
  </div>
  <!-- Music Player -->
  <div id="player-container">
    <img id="album-thumbnail" src="Misc/pics/1900x1900-000000-80-0-0.jpg" alt="Album Thumbnail" />
    <audio id="audio-player" autoplay></audio>
    <div id="track-info">
      <h2 id="track-title">Track Title</h2>
      <p id="track-artist">Artist Name</p>
    </div>

    <div class="controls">
      <button onclick="previousTrack()" class="control-btn">« Prev</button>
      <button onclick="playPauseTrack()" class="control-btn">▶ Play</button>
      <button onclick="nextTrack()" class="control-btn">» Next</button>
    </div>

    <div class="progress-bar-container">
      <input type="range" id="progress-bar" value="0" min="0" max="100">
    </div>

    <div class="time-info">
      <span id="current-time">0:00</span> / <span id="total-duration">0:00</span>
    </div>
  </div>
  <div id="track-list">
    <h3>Track List</h3>
    <ul id="track-list-container">
    </ul>
  </div>
</div>
  <script>

    var albums = [
      {
        title: "Show By Rock",
        artist: "Tsurezurenaru Ayatsuri Mugenan",

        thumbnail: "Misc/pics/1900x1900-000000-80-0-0.jpg",
        tracks: [
          { title: "十六夜ゐ", artist: "徒然なる操り霧幻庵", src: "Misc/tracks/十六夜ゐ - 徒然なる操り霧幻庵 (Tsurezurenaru Ayatsuri Mugenan)(MP3_160K).mp3" },
          { title: "SASURAI", artist: "徒然なる操り霧幻庵", src: "Misc/tracks/_SASURAI_ - 徒然なる操り霧幻庵 (Tsurezurenaru Ayatsuri Mugenan)(MP3_160K).mp3" },
          { title: "Tabimichi Yoiyoi Yume Hanabi", artist: "徒然なる操り霧幻庵", src: "Misc/tracks/Tabimichi Yoiyoi Yume Hanabi - 徒然なる操り霧幻庵 (Tsurezurenaru Ayatsuri Mugenan)(MP3_160K).mp3" }
        ],
        backgroundImage: "url('Misc/pics/Tsurezure_naru_live_daru_dayu.webp')"
      },
      {
        title: "Dohna Dohna",
        artist: "AliceSoft",
        thumbnail: "Misc/pics/Antenna.(Dohna.Dohna).full.3598952.jpg",
        tracks: [
          { title: "Whatcha;Whatcha Doin", artist: "AliceSoft", src: "Misc/tracks/Whatcha_Whatcha Doin_(MP3_160K)_1.mp3" },
          { title: "SPARKs", artist: "AliceSoft", src: "Misc/tracks/SPARKs(MP3_160K).mp3" },
          { title: "あかときやみから", artist: "AliceSoft", src: "Misc/tracks/あかときやみから(MP3_160K).mp3" }
        ],
        backgroundImage: "url('Misc/pics/cg1-1-1024x576.jpg')"
      },
      {
        title: "Will Stetson",
        artist: "Will Stetson",
        thumbnail: "Misc/pics/download.png",
        tracks: [
          { title: "Live in Life ", artist: "Will Stetson", src: "Misc/tracks/Live in Life - Will Stetson [MV] 【Hu Tao Fansong】(MP3_160K).mp3" },
          { title: "Morality Lesson", artist: "Will Stetsont", src: "Misc/tracks/Morality Lesson - Will Stetson [MV] 【HSR Fansong】(M4A_128K).m4a" },
          { title: "Writing on the Wall ", artist: "Will Stetson", src: "Misc/tracks/Writing on the Wall - Will Stetson [MV] 【Kaveh Fansong】(MP3_160K).mp3" }
        ],
        backgroundImage: "url('Misc/pics/459084521_1952439661890361_1712876725948218878_n.jpg')"
      },
      {
        title: "GARNiDELiA",
        artist: "GARNiDELiA",
        thumbnail: "Misc/pics/download5.jfif",
        tracks: [
          { title: "極楽浄土[Gokuraku Jodo]", artist: "GARNiDELiA", src: "Misc/tracks/【みうめ・メイリア・217】極楽浄土[Gokuraku Jodo]  OFFiCiAL(MP3_160K).mp3" },
          { title: "宵闇胡蝶[Yoiyami Kocho]", artist: "GARNiDELiA", src: "Misc/tracks/【りりちよ・メイリア】宵闇胡蝶[Yoiyami Kocho] OFFiCiAL【踊っちゃってみた第10弾】(MP3_160K).mp3" },
          { title: "謳歌爛漫[Oka Ramman]", artist: "GARNiDELiA", src: "Misc/tracks/【みうめ・メイリア・217】謳歌爛漫[Oka Ramman] OFFiCiAL【GARNiDELiA】(MP3_160K).mp3" }
        ],
        backgroundImage: "url('Misc/pics/desktop-wallpaper-steam-workshop-garnidelia-garnidelia.jpg')"
      }
    ];

    document.body.style.backgroundImage = albums[0].backgroundImage;

    var currentAlbumIndex = 0;
    var currentTrackIndex = 0;
    var audio = document.getElementById('audio-player');
    var playButton = document.querySelector('.controls button:nth-child(2)');
    var progressBar = document.getElementById('progress-bar');
    var currentTimeElem = document.getElementById('current-time');
    var durationElem = document.getElementById('total-duration');

    function loadTrack(albumIndex, trackIndex) {
      currentAlbumIndex = albumIndex;
      currentTrackIndex = trackIndex;
      var track = albums[currentAlbumIndex].tracks[currentTrackIndex];
      audio.src = track.src;
      document.getElementById('track-title').textContent = track.title;
      document.getElementById('track-artist').textContent = track.artist;
      document.body.style.backgroundImage = albums[currentAlbumIndex].backgroundImage;
      var albumThumbnail = document.getElementById('album-thumbnail');
      albumThumbnail.src = albums[currentAlbumIndex].thumbnail;
      audio.play().catch(error => {console.error("Autoplay failed", error)});
    }

    // First track
    function selectAlbum(index) {
      currentAlbumIndex = index;
      loadTrack(currentAlbumIndex, 0);
    }

    loadTrack(currentAlbumIndex, 0);

    audio.addEventListener('play', function(){
      playButton.textContent = '❚❚ Pause'
    });

    audio.addEventListener('pause', function(){
      playButton.textContent = '▶ Play'
    });

    // Pause and Play
    function playPauseTrack() {
      if (audio.paused) {
        audio.play();
      } else {
        audio.pause();
      }
    }
    audio.addEventListener('canplay', function(){
      console.log('Audio is ready to play')
    });

    // Next
    function nextTrack() {
      var album = albums[currentAlbumIndex];
      currentTrackIndex = (currentTrackIndex + 1) % album.tracks.length;
      loadTrack(currentAlbumIndex, currentTrackIndex);
    }

    // Prev
    function previousTrack() {
      var album = albums[currentAlbumIndex];
      currentTrackIndex = (currentTrackIndex - 1 + album.tracks.length) % album.tracks.length;
      loadTrack(currentAlbumIndex, currentTrackIndex);
    }

    // Progress bar
    audio.addEventListener('timeupdate', function() {
      var progress = (audio.currentTime / audio.duration) * 100;
      progressBar.value = progress || 0;

      currentTimeElem.textContent = formatTime(audio.currentTime);
      durationElem.textContent = formatTime(audio.duration);
    });

    // Time
    function formatTime(time) {
      var minutes = Math.floor(time / 60);
      var seconds = Math.floor(time % 60);
      return minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
    }

    // Seek
    progressBar.addEventListener('input', function() {
      var seekTime = (progressBar.value / 100) * audio.duration;
      audio.currentTime = seekTime;
    });

    audio.addEventListener('ended', function() {
      nextTrack();
    });

function loadTrackList(albumIndex) {
  var album = albums[albumIndex];
  var trackListContainer = document.getElementById('track-list-container');
  trackListContainer.innerHTML = ''; // Clear the list first

  // Tracklist
  album.tracks.forEach((track, index) => {
    var listItem = document.createElement('li');
    listItem.textContent = track.title + ' - ' + track.artist;
    listItem.addEventListener('click', function() {
      loadTrack(albumIndex, index); // Load the selected track
    });
    trackListContainer.appendChild(listItem);
  });
}

function selectAlbum(index) {
  currentAlbumIndex = index;
  loadTrack(currentAlbumIndex, 0); // Load the first track
  loadTrackList(currentAlbumIndex); // Load the track list
}
  </script>

  <!-- Popup login button -->
  <div class="login-popup">
    <button onclick="toggleLoginForm()">Login</button>
  </div>

  <!-- Popup login form -->
  <div class="login-form" id="loginForm">
    <h3>Login</h3>
    <form>
      <input type="text" placeholder="Username" required>
      <input type="password" placeholder="Password" required>
      <input type="submit" value="Login">
    </form>
  </div>

  <script>
    // Toggle login form visibility
    function toggleLoginForm() {
      var loginForm = document.getElementById("loginForm");
      loginForm.style.display = (loginForm.style.display === "block") ? "none" : "block";
    }

    // Toggle sidebar visibility
    function toggleSidebar() {
      var sidebar = document.getElementById("sidebar");
      var toggleButton = document.getElementById("toggleButton");

      sidebar.classList.toggle("active");
      toggleButton.classList.toggle("hidden");
    }
  </script>

</body>
</html>